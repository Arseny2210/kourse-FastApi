<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - –°–ª–æ–≤–∞—Ä—å</title>
		<link rel="stylesheet" href="/static/css/style.css" />
	</head>
	<body>
		<div class="container">
			<header>
				<div class="user-header">
					<h1>üëã –ü—Ä–∏–≤–µ—Ç, {{ user.username }}!</h1>
					<a href="/logout" class="logout-btn">–í—ã–π—Ç–∏</a>
				</div>
			</header>

			<main>
				{% if error %}
				<div class="error-message">{{ error }}</div>
				{% endif %} {% if success %}
				<div class="success-message">{{ success }}</div>
				{% endif %}

				<div class="add-flashcard-section">
					<h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É</h2>
					<form id="add-flashcard-form" method="POST" action="/web/flashcards">
						<div class="form-group">
							<label for="foreign_word">–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ:</label>
							<input
								type="text"
								id="foreign_word"
								name="foreign_word"
								required
								maxlength="100"
								placeholder="Hello"
							/>
						</div>
						<div class="form-group">
							<label for="native_word">–ü–µ—Ä–µ–≤–æ–¥:</label>
							<input
								type="text"
								id="native_word"
								name="native_word"
								required
								maxlength="100"
								placeholder="–ü—Ä–∏–≤–µ—Ç"
							/>
						</div>
						<div class="form-group">
							<label for="example">–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
							<textarea
								id="example"
								name="example"
								maxlength="500"
								placeholder="Hello, how are you?"
							></textarea>
						</div>
						<button type="submit" class="btn btn-primary">
							–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
						</button>
					</form>
				</div>

				<div class="section">
					<div class="flashcards-header">
						<h2>üìù –í–∞—à–∏ –∫–∞—Ä—Ç–æ—á–∫–∏</h2>
						<div class="filter-controls">
							<button class="filter-btn active" data-filter="all">–í—Å–µ</button>
							<button class="filter-btn" data-filter="learned">
								–í—ã—É—á–µ–Ω–Ω—ã–µ
							</button>
							<button class="filter-btn" data-filter="not-learned">
								–ù–µ –≤—ã—É—á–µ–Ω–Ω—ã–µ
							</button>
						</div>
					</div>
					<div class="flashcards-container" id="flashcards-container">
						{% if flashcards %} {% for card in flashcards %}
						<div
							class="flashcard"
							data-learned="{{ 'true' if card.is_learned else 'false' }}"
						>
							<div class="card-header">
								<span
									class="learned-badge {% if card.is_learned %}active{% endif %}"
								>
									{% if card.is_learned %}‚úì –í—ã—É—á–µ–Ω–æ{% else %}–í –ø—Ä–æ—Ü–µ—Å—Å–µ{% endif
									%}
								</span>
								<div class="card-actions">
									<form
										method="POST"
										action="/web/flashcards/{{ card.id }}/mark-learned"
										class="inline-form"
									>
										<button
											type="submit"
											class="action-btn {% if card.is_learned %}btn-success{% else %}btn-primary{% endif %}"
											title="{% if card.is_learned %}–ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –Ω–µ –≤—ã—É—á–µ–Ω–Ω—É—é{% else %}–ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –≤—ã—É—á–µ–Ω–Ω—É—é{% endif %}"
										>
											{% if card.is_learned %}üîÑ{% else %}‚úì{% endif %}
										</button>
									</form>
									<a
										href="/web/flashcards/{{ card.id }}/edit"
										class="action-btn btn-warning"
										title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
										>‚úèÔ∏è</a
									>
									<form
										method="POST"
										action="/web/flashcards/{{ card.id }}/delete"
										class="inline-form delete-form"
									>
										<button
											type="submit"
											class="action-btn btn-danger"
											title="–£–¥–∞–ª–∏—Ç—å"
											onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É?')"
										>
											üóëÔ∏è
										</button>
									</form>
								</div>
							</div>
							<div class="card-content">
								<div class="foreign-word">{{ card.foreign_word }}</div>
								<div class="native-word">{{ card.native_word }}</div>
								{% if card.example %}
								<div class="example">{{ card.example }}</div>
								{% endif %}
							</div>
							<div class="card-footer">
								<div class="stats">
									<span title="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π"
										>üìö {{ card.repetitions }}</span
									>
									{% if card.last_reviewed %}
									<span title="–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ"
										>üìÖ {{ card.last_reviewed.strftime('%d.%m.%Y') }}</span
									>
									{% endif %}
								</div>
							</div>
						</div>
						{% endfor %} {% else %}
						<div class="no-cards">
							<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É –≤—ã—à–µ!</p>
						</div>
						{% endif %}
					</div>
				</div>

				<div class="section stats-section">
					<h2>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
					<div class="stats">
						<div class="stat-card">
							<h3>–í—Å–µ–≥–æ –∫–∞—Ä—Ç–æ—á–µ–∫</h3>
							<p class="stat-number">{{ flashcards|length }}</p>
						</div>
						<div class="stat-card">
							<h3>–í—ã—É—á–µ–Ω–æ</h3>
							<p class="stat-number">
								{{ flashcards|selectattr('is_learned')|list|length }}
							</p>
						</div>
						<div class="stat-card">
							<h3>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</h3>
							<p class="stat-number">
								{{ flashcards|rejectattr('is_learned')|list|length }}
							</p>
						</div>
					</div>
				</div>
			</main>
		</div>

		<script>
			document.addEventListener('DOMContentLoaded', function () {
				const filterButtons = document.querySelectorAll('.filter-btn')
				const flashcards = document.querySelectorAll('.flashcard')

				filterButtons.forEach(button => {
					button.addEventListener('click', function () {
						filterButtons.forEach(btn => btn.classList.remove('active'))
						this.classList.add('active')

						const filter = this.dataset.filter

						flashcards.forEach(card => {
							const isLearned = card.dataset.learned === 'true'

							switch (filter) {
								case 'all':
									card.style.display = 'block'
									break
								case 'learned':
									card.style.display = isLearned ? 'block' : 'none'
									break
								case 'not-learned':
									card.style.display = !isLearned ? 'block' : 'none'
									break
							}
						})
					})
				})

				const deleteForms = document.querySelectorAll('.delete-form')
				deleteForms.forEach(form => {
					form.addEventListener('submit', function (e) {
						if (
							!confirm(
								'–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ä—Ç–æ—á–∫—É? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.'
							)
						) {
							e.preventDefault()
						}
					})
				})

				const messages = document.querySelectorAll(
					'.error-message, .success-message'
				)
				messages.forEach(message => {
					message.style.opacity = '0'
					message.style.transition = 'opacity 0.3s ease'

					setTimeout(() => {
						message.style.opacity = '1'
					}, 100)

					setTimeout(() => {
						message.style.opacity = '0'
						setTimeout(() => {
							message.remove()
						}, 300)
					}, 5000)
				})
			})
		</script>

		<style>
			:root {
				--primary-color: #4361ee;
				--success-color: #06d6a0;
				--danger-color: #ef476f;
				--warning-color: #ffd166;
				--dark-color: #111;
				--light-color: #f8f9fa;
				--max-width: 1200px;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				line-height: 1.6;
				color: #333;
				background-color: #f5f7fb;
			}

			.container {
				width: 90%;
				max-width: var(--max-width);
				margin: 0 auto;
				padding: 0 15px;
			}

			header {
				background-color: white;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
				position: sticky;
				top: 0;
				z-index: 100;
				padding: 1rem 0;
			}

			.user-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.logout-btn {
				background-color: var(--danger-color);
				color: white;
				text-decoration: none;
				padding: 8px 16px;
				border-radius: 4px;
				font-weight: 500;
				transition: opacity 0.3s ease;
			}

			.logout-btn:hover {
				opacity: 0.9;
			}

			main {
				min-height: calc(100vh - 150px);
				padding: 2rem 0;
			}

			.error-message {
				background-color: #ffebee;
				color: #c62828;
				padding: 12px 16px;
				border-radius: 4px;
				margin-bottom: 1rem;
				border-left: 4px solid #f44336;
			}

			.success-message {
				background-color: #e8f5e9;
				color: #2e7d32;
				padding: 12px 16px;
				border-radius: 4px;
				margin-bottom: 1rem;
				border-left: 4px solid #4caf50;
			}

			.add-flashcard-section {
				background: white;
				border-radius: 10px;
				padding: 1.5rem;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				margin-bottom: 2rem;
			}

			.add-flashcard-section h2 {
				margin-bottom: 1.5rem;
				color: var(--dark-color);
				display: flex;
				align-items: center;
				gap: 10px;
			}

			.form-group {
				margin-bottom: 1rem;
			}

			.form-group label {
				display: block;
				margin-bottom: 0.5rem;
				font-weight: 500;
			}

			.form-group input,
			.form-group textarea {
				width: 100%;
				padding: 0.75rem;
				border: 1px solid #ddd;
				border-radius: 4px;
				font-size: 1rem;
				font-family: inherit;
			}

			.form-group textarea {
				min-height: 80px;
				resize: vertical;
			}

			.btn {
				display: inline-block;
				padding: 0.75rem 1.5rem;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 1rem;
				font-weight: 500;
				transition: all 0.3s ease;
			}

			.btn-primary {
				background-color: var(--primary-color);
				color: white;
			}

			.btn-success {
				background-color: var(--success-color);
				color: #111;
			}

			.btn-danger {
				background-color: var(--danger-color);
				color: white;
			}

			.btn-warning {
				background-color: var(--warning-color);
				color: #111;
				text-decoration: none;
				display: inline-block;
				text-align: center;
			}

			.btn:hover {
				opacity: 0.9;
			}

			.section {
				background: white;
				border-radius: 10px;
				padding: 1.5rem;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				margin-bottom: 2rem;
			}

			.flashcards-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 1.5rem;
			}

			.filter-controls {
				display: flex;
				gap: 0.5rem;
			}

			.filter-btn {
				padding: 0.5rem 1rem;
				border: 1px solid #ddd;
				border-radius: 4px;
				background: white;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.filter-btn.active {
				background-color: var(--primary-color);
				color: white;
				border-color: var(--primary-color);
			}

			.flashcards-container {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
				gap: 1.5rem;
			}

			.flashcard {
				border: 1px solid #ddd;
				border-radius: 8px;
				overflow: hidden;
				background: white;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
				transition: all 0.3s ease;
			}

			.flashcard:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			}

			.card-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.75rem 1rem;
				border-bottom: 1px solid #eee;
				background-color: #f8f9fa;
			}

			.learned-badge {
				font-size: 0.85rem;
				font-weight: 500;
				padding: 0.25rem 0.75rem;
				border-radius: 20px;
				background-color: #e9ecef;
				color: #6c757d;
			}

			.learned-badge.active {
				background-color: var(--success-color);
				color: #111;
			}

			.card-actions {
				display: flex;
				gap: 0.5rem;
			}

			.action-btn {
				width: 32px;
				height: 32px;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 0.9rem;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.2s ease;
				padding: 0;
			}

			.action-btn:hover {
				transform: scale(1.1);
			}

			.card-content {
				padding: 1.25rem;
			}

			.foreign-word {
				font-size: 1.5rem;
				font-weight: bold;
				color: var(--primary-color);
				margin-bottom: 0.5rem;
			}

			.native-word {
				font-size: 1.2rem;
				color: #495057;
				margin-bottom: 0.75rem;
				font-weight: 500;
			}

			.example {
				font-style: italic;
				color: #6c757d;
				padding-top: 0.5rem;
				border-top: 1px solid #eee;
				font-size: 0.95rem;
				line-height: 1.5;
			}

			.card-footer {
				padding: 0.75rem 1rem;
				border-top: 1px solid #eee;
				background-color: #f8f9fa;
				font-size: 0.85rem;
				color: #6c757d;
			}

			.stats {
				display: flex;
				gap: 1rem;
			}

			.stats span {
				display: flex;
				align-items: center;
				gap: 0.25rem;
			}

			.no-cards {
				text-align: center;
				padding: 2rem;
				color: #6c757d;
				grid-column: 1 / -1;
			}

			.stats-section {
				margin-top: 1rem;
			}

			.stats {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
				gap: 1rem;
				margin-top: 1rem;
			}

			.stat-card {
				text-align: center;
				padding: 1.25rem;
				background: #f0f4ff;
				border-radius: 8px;
				transition: transform 0.3s ease;
			}

			.stat-card:hover {
				transform: translateY(-2px);
			}

			.stat-number {
				font-size: 2rem;
				font-weight: bold;
				color: var(--primary-color);
				margin: 0.5rem 0;
			}

			.inline-form {
				display: inline;
			}

			@media (max-width: 768px) {
				.flashcards-container {
					grid-template-columns: 1fr;
				}

				.user-header {
					flex-direction: column;
					gap: 1rem;
					text-align: center;
				}

				.flashcards-header {
					flex-direction: column;
					align-items: flex-start;
					gap: 1rem;
				}

				.filter-controls {
					width: 100%;
					overflow-x: auto;
					padding-bottom: 0.5rem;
				}

				.filter-btn {
					flex: 0 0 auto;
					margin-right: 0.5rem;
				}
			}
		</style>
	</body>
</html>
